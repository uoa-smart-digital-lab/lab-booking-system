defmodule LabbookingsWeb.Schema.Item do
  use Absinthe.Schema.Notation
  require LabbookingsWeb.Schema.Enums

  alias LabbookingsWeb.ItemResolver


  # ------------------------------------------------------------------------------------------------------
  # item Schema definition
  # ------------------------------------------------------------------------------------------------------
  object :item do
    field :name, non_null(:string)
    field :image, non_null(:string)
    field :url, non_null(:string)
    field :details, non_null(:json)
  end
  # ------------------------------------------------------------------------------------------------------



  # ------------------------------------------------------------------------------------------------------
  # Queries
  # ------------------------------------------------------------------------------------------------------
  object :item_queries do
    # ----------------------------------------------------------------------------------------------------
    @desc "Get all the items"
    # ----------------------------------------------------------------------------------------------------
    field :all_items, non_null(list_of(:item)) do
      resolve(&ItemResolver.all_items/3)
    end

    # ----------------------------------------------------------------------------------------------------
    @desc "Get an item by name"
    # ----------------------------------------------------------------------------------------------------
    field :get_item, :item do
      arg :name, :string
      resolve &ItemResolver.get_item/3
    end
  end
  # ------------------------------------------------------------------------------------------------------



  # ------------------------------------------------------------------------------------------------------
  # Mutations
  # ------------------------------------------------------------------------------------------------------
  object :item_mutations do
    # ----------------------------------------------------------------------------------------------------
    @desc "Create a new item"
    # ----------------------------------------------------------------------------------------------------
    field :create_item, :item do
      arg :name, non_null(:string)
      arg :image, non_null(:string)
      arg :url, non_null(:string)
      arg :details, non_null(:json)
      resolve &ItemResolver.create_item/3
    end

    # ----------------------------------------------------------------------------------------------------
    @desc "Update an item"
    # ----------------------------------------------------------------------------------------------------
    field :update_item, :item do
      arg :name, non_null(:string)
      arg :image, :string
      arg :url, :string
      arg :details, :json
      resolve &ItemResolver.update_item/3
    end

    # ----------------------------------------------------------------------------------------------------
    @desc "Delete an item"
    # ----------------------------------------------------------------------------------------------------
    field :delete_item, :item do
      arg :name, non_null(:string)
      resolve &ItemResolver.delete_item/3
    end
  end
  # ------------------------------------------------------------------------------------------------------
end
